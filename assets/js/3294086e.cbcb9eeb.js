"use strict";(self.webpackChunkzustand_zh=self.webpackChunkzustand_zh||[]).push([[4708],{6037:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"hooks/use-shallow","title":"useShallow \u269b\ufe0f","description":"\u5982\u4f55\u8bb0\u5fc6\u9009\u62e9\u5668\u51fd\u6570","source":"@site/docs/hooks/use-shallow.md","sourceDirName":"hooks","slug":"/hooks/use-shallow","permalink":"/zustand-zh/docs/hooks/use-shallow","draft":false,"unlisted":false,"editUrl":"https://github.com/ouweiya/zustand-zh/blob/master/docs/hooks/use-shallow.md","tags":[],"version":"current","frontMatter":{"title":"useShallow \u269b\ufe0f","description":"\u5982\u4f55\u8bb0\u5fc6\u9009\u62e9\u5668\u51fd\u6570","nav":28},"sidebar":"tutorialSidebar","previous":{"title":"shallow","permalink":"/zustand-zh/docs/apis/shallow"},"next":{"title":"useStoreWithEqualityFn \u269b\ufe0f","permalink":"/zustand-zh/docs/hooks/use-store-with-equality-fn"}}');var r=s(4848),l=s(8453);const t={title:"useShallow \u269b\ufe0f",description:"\u5982\u4f55\u8bb0\u5fc6\u9009\u62e9\u5668\u51fd\u6570",nav:28},i=void 0,o={},c=[{value:"\u7b7e\u540d",id:"\u7b7e\u540d",level:3},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2},{value:"<code>useShallow(selectorFn)</code>",id:"useshallowselectorfn",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:4},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:4},{value:"\u7528\u6cd5",id:"\u7528\u6cd5",level:2},{value:"\u7f16\u5199\u8bb0\u5fc6\u9009\u62e9\u5668",id:"\u7f16\u5199\u8bb0\u5fc6\u9009\u62e9\u5668",level:3},{value:"\u6545\u969c\u6392\u9664",id:"\u6545\u969c\u6392\u9664",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useShallow"})," \u662f\u4e00\u4e2a React Hook\uff0c\u53ef\u4ee5\u8ba9\u4f60\u4f18\u5316\u91cd\u65b0\u6e32\u67d3\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const memoizedSelector = useShallow(selector)\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#%E7%B1%BB%E5%9E%8B",children:"\u7c7b\u578b"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E7%AD%BE%E5%90%8D",children:"\u7b7e\u540d"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E5%8F%82%E8%80%83",children:"\u53c2\u8003"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#%E7%94%A8%E6%B3%95",children:"\u7528\u6cd5"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E7%BC%96%E5%86%99%E8%AE%B0%E5%BF%86%E9%80%89%E6%8B%A9%E5%99%A8",children:"\u7f16\u5199\u8bb0\u5fc6\u9009\u62e9\u5668"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4",children:"\u6545\u969c\u6392\u9664"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u7b7e\u540d",children:"\u7b7e\u540d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"useShallow<T, U = T>(selectorFn: (state: T) => U): (state: T) => U\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,r.jsx)(n.h3,{id:"useshallowselectorfn",children:(0,r.jsx)(n.code,{children:"useShallow(selectorFn)"})}),"\n",(0,r.jsx)(n.h4,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"selectorFn"}),": \u4e00\u4e2a\u51fd\u6570\uff0c\u5141\u8bb8\u4f60\u8fd4\u56de\u57fa\u4e8e\u5f53\u524d\u72b6\u6001\u7684\u6570\u636e\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useShallow"})," \u8fd4\u56de\u4e00\u4e2a\u4f7f\u7528\u6d45\u6bd4\u8f83\u8fdb\u884c\u8bb0\u5fc6\u7684\u9009\u62e9\u5668\u51fd\u6570\u7684\u8bb0\u5fc6\u7248\u672c\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u7528\u6cd5",children:"\u7528\u6cd5"}),"\n",(0,r.jsx)(n.h3,{id:"\u7f16\u5199\u8bb0\u5fc6\u9009\u62e9\u5668",children:"\u7f16\u5199\u8bb0\u5fc6\u9009\u62e9\u5668"}),"\n",(0,r.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u5b58\u50a8\u6765\u4fdd\u5b58\u718a\u5bb6\u5ead\u7684\u72b6\u6001\u3002\u5728\u8fd9\u4e2a\u5b58\u50a8\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e09\u4e2a\u5c5e\u6027\uff1a",(0,r.jsx)(n.code,{children:"papaBear"}),"\u3001",(0,r.jsx)(n.code,{children:"mamaBear"})," \u548c ",(0,r.jsx)(n.code,{children:"babyBear"}),"\uff0c\u6bcf\u4e2a\u5c5e\u6027\u4ee3\u8868\u718a\u5bb6\u5ead\u7684\u4e0d\u540c\u6210\u5458\u53ca\u5176\u5404\u81ea\u7684\u7ca5\u9505\u5927\u5c0f\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { create } from 'zustand'\n\ntype BearFamilyMealsStore = {\n  [key: string]: string\n}\n\nconst useBearFamilyMealsStore = create<BearFamilyMealsStore>()(() => ({\n  papaBear: '\u5927\u7ca5\u9505',\n  mamaBear: '\u4e2d\u7b49\u5927\u5c0f\u7684\u7ca5\u9505',\n  babyBear: '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7ca5\u9505',\n}))\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"BearNames"})," \u7ec4\u4ef6\uff0c\u8be5\u7ec4\u4ef6\u68c0\u7d22\u6211\u4eec\u72b6\u6001\u7684\u952e\uff08\u718a\u5bb6\u5ead\u6210\u5458\uff09\u5e76\u663e\u793a\u5b83\u4eec\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"function BearNames() {\n  const names = useBearFamilyMealsStore((state) => Object.keys(state))\n\n  return <div>{names.join(', ')}</div>\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"UpdateBabyBearMeal"})," \u7ec4\u4ef6\uff0c\u8be5\u7ec4\u4ef6\u5b9a\u671f\u66f4\u65b0\u5c0f\u718a\u7684\u9910\u70b9\u9009\u62e9\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"const meals = [\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u76d8\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5bb9\u5668',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u676f\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5e73\u5e95\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n]\n\nfunction UpdateBabyBearMeal() {\n  useEffect(() => {\n    const timer = setInterval(() => {\n      useBearFamilyMealsStore.setState({\n        tinyBear: meals[Math.floor(Math.random() * (meals.length - 1))],\n      })\n    }, 1000)\n\n    return () => {\n      clearInterval(timer)\n    }\n  }, [])\n\n  return null\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6700\u540e\uff0c\u6211\u4eec\u5c06\u4e24\u4e2a\u7ec4\u4ef6\u7ec4\u5408\u5728 ",(0,r.jsx)(n.code,{children:"App"})," \u7ec4\u4ef6\u4e2d\u4ee5\u67e5\u770b\u5b83\u4eec\u7684\u5b9e\u9645\u6548\u679c\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"export default function App() {\n  return (\n    <>\n      <UpdateTinyBearPorridge />\n      <BearNames />\n    </>\n  )\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ee3\u7801\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { useEffect } from 'react'\nimport { create } from 'zustand'\n\ntype BearFamilyMealsStore = {\n  [key: string]: string\n}\n\nconst useBearFamilyMealsStore = create<BearFamilyMealsStore>()(() => ({\n  papaBear: '\u5927\u7ca5\u9505',\n  mamaBear: '\u4e2d\u7b49\u5927\u5c0f\u7684\u7ca5\u9505',\n  babyBear: '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7ca5\u9505',\n}))\n\nconst meals = [\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u76d8\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5bb9\u5668',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u676f\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5e73\u5e95\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n]\n\nfunction UpdateBabyBearMeal() {\n  useEffect(() => {\n    const timer = setInterval(() => {\n      useBearFamilyMealsStore.setState({\n        tinyBear: meals[Math.floor(Math.random() * (meals.length - 1))],\n      })\n    }, 1000)\n\n    return () => {\n      clearInterval(timer)\n    }\n  }, [])\n\n  return null\n}\n\nfunction BearNames() {\n  const names = useBearFamilyMealsStore((state) => Object.keys(state))\n\n  return <div>{names.join(', ')}</div>\n}\n\nexport default function App() {\n  return (\n    <>\n      <UpdateBabyBearMeal />\n      <BearNames />\n    </>\n  )\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4e00\u5207\u770b\u8d77\u6765\u90fd\u5f88\u597d\uff0c\u4f46\u6709\u4e00\u4e2a\u5c0f\u95ee\u9898\uff1a\u5373\u4f7f\u540d\u5b57\u6ca1\u6709\u6539\u53d8\uff0c",(0,r.jsx)(n.code,{children:"BearNames"})," \u7ec4\u4ef6\u4e5f\u4f1a\u4e0d\u65ad\u91cd\u65b0\u6e32\u67d3\u3002\u8fd9\u662f\u56e0\u4e3a\u7ec4\u4ef6\u5728\u72b6\u6001\u7684\u4efb\u4f55\u90e8\u5206\u53d1\u751f\u53d8\u5316\u65f6\u90fd\u4f1a\u91cd\u65b0\u6e32\u67d3\uff0c\u5373\u4f7f\u6211\u4eec\u5173\u5fc3\u7684\u7279\u5b9a\u90e8\u5206\uff08\u540d\u5b57\u5217\u8868\uff09\u6ca1\u6709\u6539\u53d8\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"useShallow"})," \u6765\u786e\u4fdd\u7ec4\u4ef6\u4ec5\u5728\u72b6\u6001\u7684\u5b9e\u9645\u952e\u53d1\u751f\u53d8\u5316\u65f6\u91cd\u65b0\u6e32\u67d3\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"function BearNames() {\n  const names = useBearFamilyStore(useShallow((state) => Object.keys(state)))\n\n  return <div>{names.join(', ')}</div>\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ee3\u7801\u5e94\u8be5\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { useEffect } from 'react'\nimport { create } from 'zustand'\nimport { useShallow } from 'zustand/react/shallow'\n\ntype BearFamilyMealsStore = {\n  [key: string]: string\n}\n\nconst useBearFamilyMealsStore = create<BearFamilyMealsStore>()(() => ({\n  papaBear: '\u5927\u7ca5\u9505',\n  mamaBear: '\u4e2d\u7b49\u5927\u5c0f\u7684\u7ca5\u9505',\n  babyBear: '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7ca5\u9505',\n}))\n\nconst meals = [\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7897',\n  '\u4e00\u4e2a\u5c0f\u5de7\u7684\u76d8\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5bb9\u5668',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u676f\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u5e73\u5e95\u9505',\n  '\u4e00\u4e2a\u5c0f\u5c0f\u7684\u7f50\u5b50',\n]\n\nfunction UpdateBabyBearMeal() {\n  useEffect(() => {\n    const timer = setInterval(() => {\n      useBearFamilyMealsStore.setState({\n        tinyBear: meals[Math.floor(Math.random() * (meals.length - 1))],\n      })\n    }, 1000)\n\n    return () => {\n      clearInterval(timer)\n    }\n  }, [])\n\n  return null\n}\n\nfunction BearNames() {\n  const names = useBearFamilyMealsStore(\n    useShallow((state) => Object.keys(state)),\n  )\n\n  return <div>{names.join(', ')}</div>\n}\n\nexport default function App() {\n  return (\n    <>\n      <UpdateBabyBearMeal />\n      <BearNames />\n    </>\n  )\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u901a\u8fc7\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"useShallow"}),"\uff0c\u6211\u4eec\u4f18\u5316\u4e86\u6e32\u67d3\u8fc7\u7a0b\uff0c\u786e\u4fdd\u7ec4\u4ef6\u4ec5\u5728\u5fc5\u8981\u65f6\u91cd\u65b0\u6e32\u67d3\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u6574\u4f53\u6027\u80fd\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u6545\u969c\u6392\u9664",children:"\u6545\u969c\u6392\u9664"}),"\n",(0,r.jsx)(n.p,{children:"\u5f85\u5b9a"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>i});var a=s(6540);const r={},l=a.createContext(r);function t(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);